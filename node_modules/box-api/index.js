var request = require('request');
var Cache = require('./lib/cache');
var FileAPI = require('./lib/file_api');
var FolderAPI = require('./lib/folder_api');

var VERSION = require('./package').version;
var API_BASE = 'https://api.box.com/2.0/';
var UPLOAD_BASE = 'https://upload.box.com/api/2.0/';

function BoxAPIClient(options) {
  var headers = {
    'authorization': 'Bearer ' + options.access_token,
    'user-agent': 'box-api/' + VERSION + ' ' + (process.release && process.release.name || 'node.js') + '/' + process.version.replace(/^v/, '')
  };

  this.request = request.defaults({
    baseUrl: API_BASE,
    headers: headers
  });
  this.uploadRequest = request.defaults({
    baseUrl: UPLOAD_BASE,
    headers: headers
  });

  this.cache = new Cache();
  this.file = new FileAPI(this);
  this.folder = new FolderAPI(this);
}

module.exports = BoxAPIClient;
